\chapter{Building Measures}

Previously, we've considered the $L^p$ norms on $\mrm C([0, 1])$ and shown that it is not complete under these norms. In order to complete $\mrm C([0, 1])$, we need to define the integral on characteristic functions $\chi_E$ for many sets $E \subseteq [0, 1]$, as they can be approximated by trapezoids. 

To do this, we want to be able measure the sizes of sets ``consistently." By ``consistent'', we mean that it satisfies a few properties that are intuitively true. For example, if $\mu$ is a function that ``measures'' the sizes of sets, then if $E$ and $F$ are two disjoint sets, then intuitively, $\mu(E \sqcup F)$ should be $\mu(E) + \mu(F)$.

\section{Families and Measures}

\begin{definition}
    If $X$ is a set, a \textbf{ring} of subsets is a collection $R \subseteq 2^X$ such that \begin{enumerate}
        \item If $E, F \in R$, then $E \cup F \in R$.
        \item If $E, F \in R$, then $E \setminus X \in R$.
    \end{enumerate}
    This additionally implies that $\varnothing$ and $E \cap F = E \cup F \setminus (E \triangle F)$ is in $R$.

    A \textbf{finitely additive measure} on $R$ is a function $\mu \colon X \to [0, \infty]$ where $\mu(E \sqcup F) = \mu(E) + \mu(F)$.
\end{definition}

It is obvious that for a finitely-additive measure we have that $\mu(\varnothing) = 0$.

However, rings and finitely-additive measures aren't good enough, because of the key word \emph{finite}. If $E_n$ is a sequence of disjoint intervals $[a, b)$, we define $\mu(E_n) = [a, b)$. We consider that \[\sum_{n = 1}^\infty \mu(E_n) < \infty \] and define \[F_n = \bigsqcup_{k = 1}^n E_k,\] we see that $\chi_{F_n}$ is a Cauchy sequence, which ``wants to'' converge to $\chi_E$, where $E = \bigcup E_k$. Thus it makes sense to define \[\mu(E) = \sum_{n = 1}^\infty \mu(E_n),\] and by doing so, we introduce countable additivity.

\begin{definition}
    A \textbf{$\sigma$-ring} is a ring that is closed under countable unions.

    A \textbf{$\sigma$-algebra} (or $\sigma$-field) is a $\sigma$-ring with the whole $X$ in it.
\end{definition}

Similarly to topologies, we can order $\sigma$-rings (or $\sigma$-algebras) by inclusion, and we have the following proposition:

\begin{proposition}
    If $\qty{\mc S_\alpha}$ is any (arbitrarily large) collection of $\sigma$-rings ($\sigma$-algebras) on $X$, then the intersection $\bigcap \mc S_\alpha$ is a $\sigma$-ring (resp. $\sigma$-algebra) on $X$. 
\end{proposition}

As a corollary we have that 

\begin{corollary}
    Any collection $\mc C \in 2^X$ has a smallest $\sigma$-ring (or $\sigma$-algebra) containing it. 

    We call this $\sigma$-ring $\mc S(\mc C)$, and we say that it is generated by $\mc C$.
\end{corollary}

\begin{example}
    If $X$ is any set, the set of finite and countable subsets of $X$ form a $\sigma$-ring on $X$. This is also the $\sigma$-ring generated by singletons.
\end{example}

\begin{definition}
    A (countably additive) \textbf{measure} on a $\sigma$-ring $\mc S$ is a function $\mu \colon \mc S \to [0, \infty]$ such that for all disjoint families of sets $E_1, E_2, \dots \in \mc S$, we have \[\mu\qty(\bigsqcup_{n = 1}^\infty E_n) = \sum_{n = 1}^\infty \mu(E_n).\]
\end{definition}

One may ask why we only consider countable additivity and not uncountable additivity. Intuitively, on the real line, the length (size) of any singleton $\qty{x}$ should be $0$, as it is smaller than any interval of positive length. However, the interval $[0, 1]$ is an uncountable disjoint union of these singletons, so uncountable additivity would imply that the length of $[0, 1]$ would be $0$.

Some examples of measures are below:

\begin{example}[Counting Measure]
    For a space $X$, we can let $\mc S$ be the set of all countable subsets of $X$, and we can define a measure on $\mc S$ by $\mu(E) = \#(E)$, which is $\infty$ if $E$ has infinite cardinality.
\end{example}

\begin{example}
    The counting measure is a special case of the measure defined as \[\mu_f(E) = \sum_{x \in E} f(x) \]where $f \colon X \to [0, \infty]$.

    The reason why this is countably additive is due to the ability to switch the order of summation when it is absolutely convergent.
\end{example}

\begin{example}
    Another special case is when $X$ itself is countable and \[ \sum_{x \in X} f(x) = 1.\] This gives rise to discrete probability measures and distributions, and $f$ is in this case known as the probability mass function. 

    As an example, taking $X = \qty{0, 1, \dots}$ and $f(n) = p(1 - p)^{n - 1}$ gives us the geometric distribution with parameter $p$.
\end{example}

\section{Prerings and Premeasures}

However, directly defining measures for more complicated $\sigma$-rings is very difficult. For instance, it would be very difficult to explicitly define a measure on the $\sigma$-ring (which happens to be a $\sigma$-algebra) generated by the intervals $[a, b)$ (we will see why we choose one end to be open later) in $\bb R$.

Thus, we try to define measures on smaller objects and then extend them to the $\sigma$-rings generated by those objects, analogouly to how we define a function on a basis of a vector space and extend it to the entire vector space. These smaller objects are called prerings.

\begin{definition}
    A \textbf{prering} (or semiring) on a set $X$ is a nonempty collection of subsets $\mc P \subseteq 2^X$ satisfying the following properties:
    \begin{enumerate}
        \item If $E, F \in \mc S$, then $E \cap F \in \mc S$.
        \item If $E, F \in \mc S$, then there exists disjoint sets $E_1, \dots, E_n \in \mc S$ such that \[E \setminus F = \bigsqcup_{i = 1}^n E_i.\]
    \end{enumerate}
\end{definition}

\begin{definition}
    A countably additive set function $\mu \colon \mc P \to [0, \infty]$ is called a \textbf{premeasure}.
\end{definition}

\begin{example}
    As above, the sets $[a, b)$ form a prering on the reals. The proof of this is simple but tedious.

    The function $\mu([a, b)) = b - a$ is a premeasure. The proof of this is less simple and even more tedious.
\end{example}

\begin{example}
    If $\alpha \colon \bb R \to \bb R$ is a nondecreasing function, that is left-continuous, then $\mu_\alpha([a, b)) = \alpha(b) - \alpha(a)$ is a premeasure. We see that the preceding example is a special case of this.

    Another special case is when $\alpha(x) \to 0$ as $x \to -\infty$, and $\alpha(x) \to 1$ as $x \to \infty.$ This gives rise to continuous probability distributions on $\bb R$.
\end{example}

\begin{proposition}
    $\mu_\alpha$ is an example of a premeasure.
\end{proposition}

\begin{proof}
    To show that this is indeed a premeasure, we consider $[a_0, b_0) = \bigsqcup [a_n', b_n')$ and for all $\veps$ we set $\veps_j = 2^{-n - 1}\veps$. Then, we pick $b' < b$ such that $\alpha(b') + \veps/2 > \alpha(b)$. Now, for each $j$, choose $a_j' < a_j$ such that $\alpha(a_j') + \veps_j > \alpha(a_j)$. Then, $(a_j', b_j)$ form an open covering of $[a_0, b_0']$. We can then find a finite subcover $\mc C$. We want to reorder and renumber inductively the sets in this interval, to make the sets disjoint members of the prering. As a first step, we choose $S = (a_1', b_1) \in \mc C$ such that $a_0 \in S$, and we call it $S_1$. Now, there's an interval containing $b_1$, and we do a similar process until we run out of sets. Now, \[\sum_{j = 1}^n \alpha(b_j) - \alpha(a_j') = -\alpha(a_1) + \sum_{j = 1}^{n - 1} \alpha(b_j) - \alpha(a_{j + 1}') + \alpha(b_n) \ge \alpha(b_n) - \alpha(a_1') > \alpha(b_0) - \alpha(a_0) - \veps/2.\] We also have that \[\sum_{j = 1}^n \alpha(b_j) - \alpha(a_j') < \sum_{j = 1}^n \alpha(b_j) - \alpha(a_j) + \veps_j  \le \veps/2 + \sum_{j = 1}^\infty \alpha(b_j) - \alpha(a_j).\] Combining these we get that \[\mu_\alpha([a_0, b_0)) - \veps/2 < \alpha(b_0) - \alpha(a_0) - \veps/2< \sum_{j = 1}^n \alpha(b_j) - \alpha(a_j') < \veps/2 +  \sum_{j = 1}^\infty = \veps/2 + \sum_{j = 1}^n \mu_\alpha([a_j, b_j)\]

    The fact that the sum of the measures is greater than or equal to the measure of the union follows from taking $\veps \to 0$. The fact that the sum of the measures is at most the measure of the union follows from considering the partial sums.
\end{proof}

\section{Caratheodory's Extension Theorem}

The main reason why we were interested in prerings and premeasures is because we can extend premeasures on prerings to measures on $\sigma$-rings.

The main star of the show is

\begin{theorem}[Caratheodory's Extension Theorem]
    If $\mc P$ is a prering and $\mu$ is a premeasure, then it extends to a measure $\mu$ on $\mc S = S(\mc P)$.
\end{theorem}

A few lemmas first, before we can build up to the theorem:

\begin{lemma}
    If $E$, $F_1, \dots, F_n$ are all in $\mc P$, then $E \setminus \bigcup F_k$ is the disjoint union of sets in $\mc P$.
\end{lemma}

\begin{proof}
    Slightly messy, but pretty straightforward.
\end{proof}

This leads to a few important corollaries:

\begin{corollary}
    If $E \subseteq F$, then $\mu(E) \le \subseteq \mu(F)$, i.e. $\mu$ is monotone.
\end{corollary}

\begin{corollary}
    If $E = \bigcup F_k$, then $\mu(E) \le \sum \mu(F_k)$, i.e. $\mu$ is (countably) subadditive.
\end{corollary}

\begin{proof}
    Given a sequence $F_k$ then we can ``disjointize'' it by defining \[G_k = F_k \setminus \bigcup_{j = 1}^{k - 1}F_k.\] Now we apply the preceding results.
\end{proof}

\begin{definition}
    Let $\mc F$ be any family of subsets of $X$, then $\mc H(\mc F)$ is the \textbf{hereditary\footnote{Heriditary just means if $E$ is in the family, then all subsets of $E$ are also in the family.} $\sigma$-ring} of sets that are countably covered by $\mc F$.
\end{definition}

\begin{definition}
    If $\mc F$ is a family and $\mu \colon \mc F \to [0, \infty]$, then define $\mu^* \colon \mc H(\mc F) \to [0, \infty]$ by 
    \[\mu^*(A) = \inf \qty{\sum_{j = 1}^\infty \mu(E_j) \colon E_j \in \mc F, A \subseteq \bigcup_{j = 1}^\infty E_j}.\]

    For $\mc F$ a prering and $\mu$ a premeasure, then $\mu^*$ is called the \textbf{outer measure} induced by $\mu$.
\end{definition}

\begin{proposition}
    $\mu^*$ is countably subadditive and monotone, i.e., $\mu^*$ is an \textbf{outer measure}.
\end{proposition}

\begin{proof}
    Monotonicity is trivial, but for subadditivity, suppose $B_1, \dots, B_k$ are in $\mc H(\mc F)$, then for any $\veps$ we let $\veps_j = 2^{-j - 1}\veps$. Now, for each $B_j$ we have sets $E_k^j$ such that $B_j \subseteq \bigcup_k E^j_k$, and $\mu^*(B_j) + \veps_j \ge \sum_k \mu(B_k^j)$. Now, we have \[\mu^*\qty(\bigcup_j B_j) \le \sum_j \sum_k \mu(E^j_k) \le \sum_j \mu^*(B_j) + \veps_j \le \veps + \sum_j \mu^*(B_j).\] Since $\veps$ can be made arbitrarily small, we prove the desired inequality.
\end{proof}

However, while $\mu^*$ is subadditive, it turns out that it isn't necessarily countably additive. If we want to make it countably additive, we have to restrict the domain, which leads to the following clever definition:

\begin{definition}
    If $\mc H$ is a hereditary $\sigma$-ring on $X$ and $\nu$ is an outer measure on $\mc H$, then we say a set $E \in \mc H$ is \textbf{$\nu$-measurable} iff it ``splits'' every $A \in \mc H$, that is, $\nu(A) = \nu(A \setminus E) + \nu(A \cap E)$.

    We denote the $\nu$-measurable subsets by $M(\nu)$.
\end{definition}

\begin{proposition}[Caratheodory]
    $M(\nu)$ is a $\sigma$-ring and $\nu\vert_{M(\nu)}$ is a measure.
\end{proposition}

We first prove a lemma:

\begin{lemma}
    $M(\nu)$ is a ring and for any $A \in \mc H$, $E, F \in \mc H$ disjoint, we have $\nu(A \cap (E \cup F)) = \nu(A \cap E) + \nu(A \cap F)$.
\end{lemma}

\begin{proof}
    We first prove that $M(\nu)$ is closed under finite unions. If $E, F$ are measurable, from subadditivity we have $\nu(A \cap (E \cup F)) + \nu(A \setminus (E \cup F)) \ge \nu(A)$. However, we also have that \begin{align*}
        \nu(A \cap (E \cup F)) + \nu(A \setminus (E \cup F)) &= \nu((A \cap E) \cup (A \setminus E) \cap F) + \nu((A \setminus E) \setminus F) \\
        &\le \nu(A \cap E) + \nu((A \setminus E) \cap F) + \nu((A \setminus E) \setminus F)\\
        &= \nu(A \cap E) + \nu(A \setminus E) \tag{because $F$ splits $A \setminus E$}\\
        &= \nu(A)
    \end{align*}
    thus $\nu(A \cap (E \cup F)) + \nu(A \setminus (E \cup F)) = \nu(A)$.

    Now, we prove that $M(\nu)$ is closed under set difference. If $E, F$ are measurable, one direction of the inequality follows from subadditivity. Now, we have that 
    \begin{align*}
        \nu(A \cap (E \setminus F)) + \nu(A \setminus (E \setminus F)) &= \nu((A \cap E) \setminus F) + \nu((A \setminus E) \cup (A \cap (E \cap F)))\\
        &\le \nu((A \cap E) \setminus F) + \nu(A \setminus E) + \nu((A \cap E) \cap F)\\
        &= \nu(A \cap E) + \nu(A \setminus E)\\
        &= \nu(A).
    \end{align*}

    Now, we prove the last property. Since $E$ splits $A \cap (E \cup F)$, then we have $\nu(A \cap (E \cup F) \cap E) + \nu((A \cap (E \cup F)) \setminus E) = \nu(A \cap E) + \nu(A \cap F) = \nu(A \cap (E \cup F))$.
\end{proof}

We have a couple of corollaries:

\begin{corollary}
    $\nu\vert_{M(\nu)}$ is finitely additive.
\end{corollary}

\begin{corollary}
    If $E_k$ are a disjoint finite sequence of measurable sets, then $\nu1.(A \cap \bigsqcup E_k) = \sum \nu(\cap E_k)$
\end{corollary}

Now we prove that $M(\nu)$ is a $\sigma$-ring and that $\nu$ is countably additive on $M(\nu)$.

\begin{proof}
    If $E_j$ is a sequence of measurable sets, then we can disjointize the $E_j$ by setting \[F_k = E_k \setminus \bigcup_{j = 1}^{k - 1} E_j.\] Now, each $F_k$ is measurable due to $M(\nu)$ being a ring, and now we prove that $G = \bigsqcup F_j$ is measurable. Now, for all $n$, \begin{align*}
        \nu(A) &= \nu\qty(A \cap \bigsqcup_{j = 1}^n F_k) + \nu\qty(A \setminus \bigsqcup_{j = 1}^n F_k)\\ 
        &\ge \nu(A \setminus G) + \sum_{j = 1}^n \nu(A \cap E_j).
    \end{align*}
    and thus as a corollary, \[\nu(A) \ge \nu(A \setminus G) + \sum_{j = 1}^\infty \nu(A \cap E_j) \ge \nu(A \setminus G) + \nu(A \cap G).\]

    Now, to prove countable additivity, just take $A = G$ in the previous proof.
\end{proof}

We have now proved Caratheodory's Extension Theorem in full, as if $\nu$ is the outer measure induced by the premeasure $\mu$, it is easy to see that $\nu$ is an extension of $\mu$ to a $\sigma$-ring containing $\mc S(\mc P)$. 

An important case of this extension theorem is the following:

\begin{example}
    Applying this extension to the premeasures $\mu_\alpha$ as in Proposition 5.6, we get the \textbf{Lebesgue-Stiltjes measures}. When $\alpha$ is the identity, we get the \textbf{Lebesgue measure}.
\end{example}
